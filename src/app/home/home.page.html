<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>
       Cadastro de PreÃ§o LCM Hortifruti - AV3
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="container">
    <!-- FormulÃ¡rio lindÃ£o -->
    <ion-card>
      <ion-card-header>
        <ion-card-title>
          {{ editando() ? 'âœï¸ Editar Fruta' : 'â• Adicionar Nova Fruta' }}
        </ion-card-title>
      </ion-card-header>
      
      <ion-card-content>
        <ion-list>
          <ion-item>
            <ion-label position="stacked">Nome da Fruta</ion-label>
            <ion-input 
              [(ngModel)]="novaFruta().nome" 
              placeholder="Ex: MaÃ§Ã£, Banana, Laranja..."
            ></ion-input>
          </ion-item>
          
          <ion-item>
            <ion-label position="stacked">PreÃ§o KG (R$)</ion-label>
            <ion-input 
              type="number" 
              [(ngModel)]="novaFruta().preco" 
              placeholder="0.00"
            ></ion-input>
          </ion-item>
          
          <ion-item>
            <ion-label position="stacked">Fornecedor</ion-label>
            <ion-input 
              [(ngModel)]="novaFruta().fornecedor" 
              placeholder="Nome do fornecedor"
            ></ion-input>
          </ion-item>
        </ion-list>
        
        <div class="buttons">
          @if (editando()) {
            <ion-button expand="block" color="success" (click)="atualizarFruta()">
              <ion-icon slot="start" name="checkmark"></ion-icon>
              Atualizar
            </ion-button>
            <ion-button expand="block" color="medium" (click)="cancelarEdicao()">
              <ion-icon slot="start" name="close"></ion-icon>
              Cancelar
            </ion-button>
          } @else {
            <ion-button expand="block" color="primary" (click)="adicionarFruta()">
              <ion-icon slot="start" name="add"></ion-icon>
              Adicionar Fruta
            </ion-button>
          }
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Listinha de Frutas -->
    <ion-card>
      <ion-card-header>
        <ion-card-title>ğŸ“¦ Frutas Cadastradas</ion-card-title>
      </ion-card-header>
      
      <ion-card-content>
        @if (frutas$ | async; as frutas) {
          @if (frutas.length === 0) {
            <div class="empty-state">
              <ion-icon name="alert-circle-outline" size="large"></ion-icon>
              <p>Nenhuma fruta cadastrada ainda.</p>
              <p>Adicione a primeira fruta acima! ğŸ‘†</p>
            </div>
          } @else {
            <ion-list>
              @for (fruta of frutas; track fruta.id) {
                <ion-item>
                  <ion-label>
                    <h2>ğŸ {{ fruta.nome }}</h2>
                    <p>ğŸ’° PreÃ§o: R$ {{ fruta.preco | number:'1.2-2' }}</p>
                    <p>ğŸ¢ Fornecedor: {{ fruta.fornecedor }}</p>
                  </ion-label>
                  
                  <div slot="end" class="item-actions">
                    <ion-button 
                      fill="clear" 
                      color="warning" 
                      (click)="editarFruta(fruta)"
                    >
                      <ion-icon slot="icon-only" name="construct-outline"></ion-icon>
                    </ion-button>
                    
                    <ion-button 
                      fill="clear" 
                      color="danger" 
                      (click)="excluirFruta(fruta.id!)"
                    >
                      <ion-icon slot="icon-only" name="remove-circle-outline"></ion-icon>
                    </ion-button>
                  </div>
                </ion-item>
              }
            </ion-list>
          }
        } @else {
          <ion-item>
            <ion-label>
              <ion-skeleton-text animated style="width: 80%"></ion-skeleton-text>
              <ion-skeleton-text animated style="width: 60%"></ion-skeleton-text>
            </ion-label>
          </ion-item>
        }
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>